(function(t){function e(e){for(var s,c,i=e[0],o=e[1],u=e[2],l=0,h=[];l<i.length;l++)c=i[l],Object.prototype.hasOwnProperty.call(n,c)&&n[c]&&h.push(n[c][0]),n[c]=0;for(s in o)Object.prototype.hasOwnProperty.call(o,s)&&(t[s]=o[s]);d&&d(e);while(h.length)h.shift()();return r.push.apply(r,u||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],s=!0,i=1;i<a.length;i++){var o=a[i];0!==n[o]&&(s=!1)}s&&(r.splice(e--,1),t=c(c.s=a[0]))}return t}var s={},n={app:0},r=[];function c(e){if(s[e])return s[e].exports;var a=s[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,c),a.l=!0,a.exports}c.m=t,c.c=s,c.d=function(t,e,a){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(c.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)c.d(a,s,function(e){return t[e]}.bind(null,s));return a},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/vuejsMessenger/dist/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],o=i.push.bind(i);i.push=e,i=i.slice();for(var u=0;u<i.length;u++)e(i[u]);var d=o;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"231a":function(t,e,a){},"2e16":function(t,e,a){},"4aeb":function(t,e,a){"use strict";var s=a("d126"),n=a.n(s);n.a},"4c84":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("f751"),a("097d");var s=a("2b0e"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},r=[],c={name:"MessengerApp"},i=c,o=(a("7c55"),a("2877")),u=Object(o["a"])(i,n,r,!1,null,null,null),d=u.exports,l=a("8c4f"),h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("chat-window",{scopedSlots:t._u([{key:"list",fn:function(){return[a("chat-list",{attrs:{messagesCount:151,chatList:t.chatList,chatSelectedId:+t.chatId},on:{"select-chat":t.onChatSelect}})]},proxy:!0},{key:"form",fn:function(){return[a("chat-form",{attrs:{isDisconnect:!t.chatId,chatMessages:t.selectedChatMessages,isDataLoading:t.chatDataLoading,isPostProcessing:t.chatPostProcessing},on:{"post-message":t.onPostMessage}})]},proxy:!0}])})},p=[],f=(a("8e6e"),a("ac6a"),a("456d"),a("96cf"),a("3b8d")),m=a("bd86"),g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"chatWindow"},[a("div",{staticClass:"chatWindow__list"},[t._t("list",[t._v("Список чатов")])],2),a("div",{staticClass:"chatWindow__form"},[t._t("form",[t._v("Форма сообщений")])],2)])},v=[],_={name:"comp_ChatWindow"},b=_,y=(a("c20b"),Object(o["a"])(b,g,v,!1,null,null,null)),j=y.exports,O=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"fade"}},[a("div",{staticClass:"chatList"},[a("h2",{staticClass:"chatList__header"},[t._v("\n      Сообщения\n      "),a("span",{staticClass:"chatList__header__count"},[t._v("\n        "+t._s(t.messagesCount)+"\n      ")])]),a("div",{staticClass:"chatList__items"},t._l(t.chatList,(function(e){return a("chat-list-item",{key:e.id,attrs:{isSelected:e.id===t.chatSelectedId,subject:e.subject,date:e.date,text:e.text},nativeOn:{click:function(a){return t.onChatItemClick(e.id)}}})})),1)])])},C=[],w=a("768b"),x=(a("c5f6"),a("b9f0"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:{chatListItem:!0,chatListItem_selected:t.isSelected}},[a("div",{staticClass:"chatListItem__subject"},[t._v("\n    "+t._s(t.subject)+"\n  ")]),a("div",{staticClass:"chatListItem__date"},[t._v("\n    "+t._s(t.formattedDate)+"\n  ")]),a("div",{staticClass:"chatListItem__preview"},[t._v("\n    "+t._s(t.text)+"\n  ")])])}),M=[],I=(a("28a5"),/[12]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[0-1]) ([01]\d|2[0-3]):[0-5]\d/),P=["Янв","Фев","Мар","Апр","Мая","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],D={name:"comp_chatListItem",props:{subject:{type:String,required:!0},date:{validator:function(t){return"string"===typeof t&&I.test(t)}},text:{type:String},isSelected:Boolean},computed:{formattedDate:function(){var t=this.date.split(" ")[0].split("-"),e=parseInt(t[0]),a=parseInt(t[2]),s=parseInt(t[1])-1;return"".concat(a," ").concat(P[s]," ").concat(e)}}},L=D,S=(a("8d03"),Object(o["a"])(L,x,M,!1,null,null,null)),F=S.exports,k={name:"comp_chatList",components:{ChatListItem:F},props:{messagesCount:{type:Number,default:0},chatList:{validator:function(t){if(Array.isArray(t)){if(t.length){var e=Object(w["a"])(t,1),a=e[0];return a.subject&&a.date}return!0}return!1}},chatSelectedId:{type:Number,default:0}},methods:{onChatItemClick:function(t){this.$emit("select-chat",t)}}},$=k,E=(a("fb55"),Object(o["a"])($,O,C,!1,null,null,null)),R=E.exports,q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"chatForm"},[a("div",{directives:[{name:"chat-scroll",rawName:"v-chat-scroll"}],staticClass:"chatForm__dialog"},[a("div",{class:{"chatForm__dialog-container":!0,"chatForm__dialog-container_empty":t.isDataLoading||t.isDisconnect}},[t.isDisconnect?[a("h3",{key:"empty-chat-dialog-text"},[t._v("Выберите диалог в панели слева")])]:t.isDataLoading?[a("chat-form-loading-indicator",{key:"loading-chat-data-indicator"})]:t._l(t.chatMessages,(function(t){return a("chat-form-message",{key:t.id,class:{"chatForm__dialog-item":!0,"chatForm__dialog-item_self":!t.isIncoming},attrs:{self:!t.isIncoming,author:t.author,date:t.date,text:t.text}})}))],2)]),a("div",{class:{chatForm__input:!0,chatForm__input_processing:t.isPostProcessing,chatForm__input_hidden:t.isDisconnect}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],ref:"inputField",staticClass:"chatForm__input-field",attrs:{readonly:t.isPostProcessing,placeholder:"Введите текст...",rows:"1"},domProps:{value:t.message},on:{keypress:function(e){return e.type.indexOf("key")||13===e.keyCode?(e.preventDefault(),t.onMessageEnter(e)):null},input:[function(e){e.target.composing||(t.message=e.target.value)},t.checkMessageFieldResize]}}),a("div",{ref:"inputShadow",staticClass:"chatForm__input-field-shadow"},[t._v("\n      "+t._s(t.message)+"\n    ")]),a("button",{class:{"chatForm__post-button":!0,"chatForm__post-button_disabled":t.isPostProcessing||!t.message},on:{click:t.onMessageEnter}},[a("svg",{attrs:{width:"22",height:"18",viewBox:"0 0 22 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[a("path",{attrs:{d:"M0.00936317 17.2563C0.00989464 17.6114 0.3701 17.8528 0.698756 17.7183L20.8694 9.46274C21.2835 9.29324 21.2835 8.70676 20.8694 8.53726L0.698758 0.281704C0.370102 0.14719 0.00989463 0.388579 0.00936317 0.743697L0.000660091 6.55894C0.000282918 6.81096 0.187529 7.02387 0.437532 7.05569L11.8171 8.504C12.3996 8.57814 12.3996 9.42186 11.8172 9.496L0.437533 10.9443C0.187529 10.9761 0.000282918 11.189 0.000660091 11.4411L0.00936317 17.2563Z",fill:"white"}})])])])])},B=[],N=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:{chatFormMessage:!0,chatFormMessage_self:t.self}},[a("div",{staticClass:"chatFormMessage__text"},[t._v("\n    "+t._s(t.text)+"\n  ")]),a("div",{staticClass:"chatFormMessage__author"},[t._v("\n    "+t._s(t.author)+"\n  ")]),a("div",{staticClass:"chatFormMessage__date"},[t._v("\n    "+t._s(t.formattedDate)+"\n  ")])])},T=[],A=/[12]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[0-1]) ([01]\d|2[0-3]):[0-5]\d/,W={name:"comp_chatFormMessage",props:{author:{type:String,required:!0},date:{validator:function(t){return"string"===typeof t&&A.test(t)}},text:{type:String},self:Boolean},computed:{formattedDate:function(){var t=this.date.split(" ")[0].split("-"),e=t[0],a=t[2],s=t[1];return"".concat(a,".").concat(s,".").concat(e," ").concat(this.date.split(" ")[1])}}},z=W,H=(a("a831"),Object(o["a"])(z,N,T,!1,null,null,null)),J=H.exports,U=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"chatFormLoadingIndicator"})},Y=[],Z={name:"comp_chatFormLoadingIndicator"},G=Z,K=(a("4aeb"),Object(o["a"])(G,U,Y,!1,null,null,null)),Q=K.exports,V={name:"comp_ChatForm",components:{ChatFormMessage:J,ChatFormLoadingIndicator:Q},props:{chatMessages:{validator:function(t){if(Array.isArray(t)){if(t.length){var e=Object(w["a"])(t,1),a=e[0];return a.author&&a.date&&a.text}return!0}return!1}},isDataLoading:Boolean,isPostProcessing:Boolean,isDisconnect:Boolean},data:function(){return{message:"",messageSent:!1}},watch:{chatMessages:function(){this.messageSent&&(this.messageSent=!1,this.message="",this.checkMessageFieldResize())}},methods:{checkMessageFieldResize:function(){var t=this;this.$nextTick((function(){t.$refs.inputField.style.height="".concat(t.$refs.inputShadow.clientHeight,"px")}))},onMessageEnter:function(){this.messageSent=!0,this.$emit("post-message",this.message)}}},X=V,tt=(a("72bf"),Object(o["a"])(X,q,B,!1,null,null,null)),et=tt.exports,at=a("2f62"),st=a("3022");function nt(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function rt(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?nt(a,!0).forEach((function(e){Object(m["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):nt(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var ct={name:"view_Messenger",components:{ChatWindow:j,ChatList:R,ChatForm:et},props:{chatId:{type:String,default:""},routingIsUsed:{type:Boolean,default:!0}},data:function(){return{chatDataLoading:!1,chatPostProcessing:!1}},watch:{chatId:function(t){this.setChatSelected(t||0)},selectedChat:function(t){this.chatId&&Object(st["isNull"])(t)?(alert("Не найден чат c id:".concat(this.chatId)),this.$router.push("/chat")):t&&Object(st["isNull"])(this.chatMessages)&&this.requestChatMessages()}},computed:rt({},Object(at["c"])(["chatList","selectedChat","chatMessages"]),{selectedChatMessages:function(){return this.chatMessages||[]}}),mounted:function(){var t=this;this.chatId&&(this.setChatSelected(this.chatId),this.$nextTick((function(){t.chatId&&Object(st["isNull"])(t.selectedChat)&&(alert("Не найден чат c id:".concat(t.chatId)),t.$router.push("/chat"))})))},methods:rt({},Object(at["d"])(["setChatSelected"]),{},Object(at["b"])(["postMessage","requestMessages"]),{onChatSelect:function(t){this.routingIsUsed&&(String(t)!==this.chatId?this.$router.push("/chat/".concat(t)):this.$router.push("/chat"))},onPostMessage:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.chatPostProcessing=!0,t.next=3,this.postMessage({chatId:this.chatId,message:e});case 3:this.chatPostProcessing=!1;case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),requestChatMessages:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.chatDataLoading=!0,t.next=3,this.requestMessages({chatId:this.chatId});case 3:this.chatDataLoading=!1;case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()})},it=ct,ot=Object(o["a"])(it,h,p,!1,null,null,null),ut=ot.exports;s["a"].use(l["a"]);var dt=new l["a"]({mode:"history",base:"/vuejsMessenger/dist/",routes:[{path:"/chat/:chatId",component:ut,props:!0},{alias:"/",path:"/chat",component:ut},{path:"*",redirect:"/chat"}]}),lt=a("75fc");a("7f7f"),a("7514");function ht(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function pt(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?ht(a,!0).forEach((function(e){Object(m["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ht(a).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}s["a"].use(at["a"]);var ft=function(){var t=new Date,e=t.getFullYear(),a=t.getMonth()+1,s=t.getDate(),n=t.getHours(),r=t.getMinutes();return"".concat(e,"-").concat(a<10?"0".concat(a):a,"-").concat(s<10?"0".concat(s):s," ").concat(n<10?"0".concat(n):n,":").concat(r<10?"0".concat(r):r)},mt=function(){return Math.round(1e4*Math.random())},gt=new at["a"].Store({state:{chatsData:[{id:1,subject:"Простой запрос",created:"2019-08-01 23:59",parts:[{id:1,author:"vasya",text:"Привет, как дела?",created:"2019-08-01 23:59"},{id:2,author:"petya",created:"2019-08-02 01:20",text:"Привет, все хорошо, спасибо!"},{id:3,author:"petya",created:"2019-08-02 05:20",text:"Pharetra, eum ut primis orci labore velit? Ridiculus. Officia mattis pariatur justo.  Ridiculus. Officia mattis pariatur justo"}]},{id:2,subject:"Вопрос по домену",created:"2016-03-02 14:19",parts:[{id:1,author:"petr",created:"2019-08-06 12:20",text:"Здравствуйте, тут есть кто-нибудь?"},{id:2,author:"vasiliy",created:"2019-08-06 12:34",text:"Да, я вас слушаю!"},{id:3,author:"petr",created:"2019-08-06 12:38",text:"Помогите мне настроить домен!"}]},{id:3,subject:"Вопрос про пену",created:"2016-03-02 14:19",parts:null},{id:4,subject:"Вопрос Диагену",created:"2016-03-02 14:19",parts:null},{id:5,subject:"Вопрос по коллагену",created:"2016-03-02 14:19",parts:null},{id:6,subject:"Когда придет Лена",created:"2016-03-02 14:19",parts:null},{id:7,subject:"А может быть на месте Гена",created:"2016-03-02 14:19",parts:null}],selectedChatId:0,userData:{name:"Александр"}},getters:{chatList:function(t){return t.chatsData.map((function(t){var e=t.parts&&t.parts.slice(-1)[0];return{id:t.id,subject:t.subject,date:e&&e.created||t.created,text:e&&e.text||""}}))},selectedChat:function(t){if(!t.selectedChatId)return null;var e=t.chatsData.find((function(e){return e.id===t.selectedChatId}));return e||null},chatMessages:function(t,e){var a=e.selectedChat;return a&&a.parts?a.parts.map((function(e){return{id:"".concat(a.id,"_").concat(e.id),author:e.author,date:e.created,text:e.text,isIncoming:t.userData.name!==e.author}})).reverse():null}},mutations:{setChatSelected:function(t,e){t.selectedChatId=+e},addChatMessages:function(t,e){var a=e.chatId,s=e.messages,n=t.chatsData.map((function(t){return t.id===+a?pt({},t,{parts:[].concat(Object(lt["a"])(t.parts||[]),Object(lt["a"])(s.map((function(t){return{id:t.id,author:t.author,created:ft(),text:t.text}}))))}):t}));t.chatsData=n}},actions:{postMessage:function(t,e){var a=t.commit,s=t.state,n=e.chatId,r=e.message;return new Promise((function(t){setTimeout((function(){var e={id:mt(),author:s.userData.name,created:ft(),text:r};a("addChatMessages",{chatId:n,messages:[e]}),t()}),3e3*Math.random())}))},requestMessages:function(t,e){var a=t.commit,s=e.chatId;return new Promise((function(t){setTimeout((function(){var e=[{id:1,author:"petr",created:"2019-08-06 12:20",text:"Здравствуйте, тут есть кто-нибудь?"},{id:2,author:"vasiliy",created:"2019-08-06 12:34",text:"Да, я вас слушаю!"},{id:3,author:"petr",created:"2019-08-06 12:38",text:"Помогите мне настроить домен!"}];a("addChatMessages",{chatId:s,messages:e}),t()}),3e3*Math.random())}))}}}),vt=a("d1d6"),_t=a.n(vt),bt=a("123d"),yt=a.n(bt);s["a"].use(_t.a),s["a"].use(yt.a),s["a"].config.errorHandler=function(t,e,a){console.group(),console.error(t),console.log(e),console.log(a),console.groupEnd()},new s["a"]({router:dt,store:gt,render:function(t){return t(d)}}).$mount("#app")},"5c48":function(t,e,a){},"72bf":function(t,e,a){"use strict";var s=a("2e16"),n=a.n(s);n.a},"7c55":function(t,e,a){"use strict";var s=a("5c48"),n=a.n(s);n.a},"8d03":function(t,e,a){"use strict";var s=a("cd1c"),n=a.n(s);n.a},a831:function(t,e,a){"use strict";var s=a("4c84"),n=a.n(s);n.a},b9f0:function(t,e,a){},c20b:function(t,e,a){"use strict";var s=a("d8ed"),n=a.n(s);n.a},cd1c:function(t,e,a){},d126:function(t,e,a){},d8ed:function(t,e,a){},fb55:function(t,e,a){"use strict";var s=a("231a"),n=a.n(s);n.a}});
//# sourceMappingURL=app-legacy.12be166a.js.map